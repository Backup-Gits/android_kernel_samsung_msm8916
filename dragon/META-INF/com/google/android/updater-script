# DRAGONFLY
ui_print("-- Mounting partitions");
ifelse(is_mounted("/system"), unmount("/system"));
mount("ext4", "EMMC", "/dev/block/bootdevice/by-name/system", "/system");
delete_recursive ("/system/app/SwitchKnoxI");
delete_recursive ("/system/app/SwitchKnoxII");
delete_recursive ("/system/app/KnoxFolderContainer");
delete_recursive("/system/container");
delete_recursive ("/system/preloadedsso");
delete_recursive ("/system/etc/secure_storage/com.sec.knox.store");
delete_recursive("/system/app/KnoxAppsUpdateAgent");
delete_recursive("/system/app/KnoxAttestationAgent");
delete_recursive("/system/app/KnoxFolderContainer2");
delete_recursive("/system/app/KnoxRemoteContentsProvider");
delete_recursive("/system/app/KnoxSetupWizardClient");
delete_recursive("/system/app/KnoxSwitcher");
delete_recursive("/system/app/SecureFolderSetupPage");
delete_recursive ("/system/app/Bridge");
delete_recursive ("/system/app/ELMAgent");
delete_recursive ("/system/app/RCPComponents");
delete_recursive ("/system/app/SecurityLogAgent");
delete_recursive ("/system/app/UniversalMDMClient");
delete_recursive ("/system/priv-app/KLMSAgent");
delete_recursive ("/system/priv-app/SPDClient");
ui_print("-- Installing WLAN module");
package_extract_file("dragon/modules/wlan", "/system/lib/modules/pronto/pronto_wlan.ko");
set_perm(0, 0, 0644, "/system/lib/modules/pronto/pronto_wlan.ko");
ui_print("-- Installing Secure Storage module");
package_extract_file("dragon/modules/libsecure", "/system/vendor/lib/libsecure_storage.so");
set_perm(0, 0, 0644, "/system/vendor/lib/libsecure_storage.so");
package_extract_file("dragon/modules/libsecure_jni", "/system/vendor/lib/libsecure_storage_jni.so");
set_perm(0, 0, 0644, "/system/vendor/lib/libsecure_storage_jni.so");
ui_print("-- Installing the kernel image");
package_extract_file("dragon/kernel/boot.img", "/dev/block/bootdevice/by-name/boot");;
ui_print("-- Done, you have successfully flashed the kernel");
ifelse(is_mounted("/system"), unmount("/system"));
